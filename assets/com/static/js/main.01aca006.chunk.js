(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{146:function(e,t,o){"use strict";o.r(t);var s=o(0),i=o.n(s),a=o(60),n=o.n(a),r=(o(77),o(2)),h=o(3),l=o(6),c=o(4),u=o(5),d=o(18),m=(o(78),o(79),o(9)),p=o(7),f=o(8),b=o(37),g=o.n(b),v=function(e){function t(e){var o;return Object(r.a)(this,t),(o=Object(l.a)(this,Object(c.a)(t).call(this,e))).drawStroke=function(e,t,s,i,a){o.borderCtx.globalCompositeOperation="source-over",o.borderCtx.clearRect(0,0,e.width,e.height);for(var n=[-1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1],r=i,h=0;h<n.length;h+=2)o.borderCtx.drawImage(e,5+n[h]*r,5+n[h+1]*r);o.borderCtx.globalCompositeOperation="source-in",o.borderCtx.fillStyle=s,o.borderCtx.fillRect(0,0,o.borderCanvas.width,o.borderCanvas.height),o.borderCtx.globalCompositeOperation="outline"===a?"destination-out":"source-over",o.borderCtx.drawImage(e,5,5),"outline"===a&&(console.log("outline"),t.fillStyle="#FFFFFF",t.fillRect(0,0,e.width,e.height)),t.drawImage(o.borderCanvas,-5,-5)},o.drawPaint=function(e,t,s,i){s.length>o.shadowPaintList.length&&(s.slice(o.shadowPaintList.length).forEach(function(t,s){var i=t.pos,a=t.size;o.shadowShape.src=t.src,e.globalCompositeOperation=t.erase?"destination-out":"source-over",e.drawImage(o.shadowShape,i.x-a.width/2,i.y-a.height/2,a.width,a.height),console.log("DRAWN ")}),o.shadowPaintList=Object(p.a)(s))},o.addPaint=function(){},o.poly=[],o.state={},o._drawnImage=!1,o._closedShape=!1,o.ctx=null,o.background=new Image,o.shadowPaintList=[],o.shadowCanvas=document.createElement("canvas"),o.shadowCanvas.setAttribute("width",e.profile.width),o.shadowCanvas.setAttribute("height",e.profile.height),o.shadowCtx=o.shadowCanvas.getContext("2d"),o.shadowSize={width:e.profile.width,height:e.profile.height},o.shadowShape=new Image,o.shadowShape.src=e.shape,o.borderCanvas=document.createElement("canvas"),o.borderCanvas.setAttribute("width",e.profile.width),o.borderCanvas.setAttribute("height",e.profile.height),o.borderCtx=o.borderCanvas.getContext("2d"),o.floodCanvas=document.createElement("canvas"),o.floodCanvas.setAttribute("width",e.profile.width),o.floodCanvas.setAttribute("height",e.profile.height),o.floodCtx=o.floodCanvas.getContext("2d"),o.tempCanvas=document.createElement("canvas"),o.tempCanvas.setAttribute("width",e.profile.width),o.tempCanvas.setAttribute("height",e.profile.height),o.tempCtx=o.tempCanvas.getContext("2d"),o.polyCanvas=document.createElement("canvas"),o.polyCanvas.setAttribute("width",e.profile.width),o.polyCanvas.setAttribute("height",e.profile.height),o.polyCtx=o.polyCanvas.getContext("2d"),o.paintCanvas=document.createElement("canvas"),o.paintCanvas.setAttribute("width",e.profile.width),o.paintCanvas.setAttribute("height",e.profile.height),o.paintCtx=o.paintCanvas.getContext("2d"),o.imageCanvas=document.createElement("canvas"),o.imageCanvas.setAttribute("width",e.profile.width),o.imageCanvas.setAttribute("height",e.profile.height),o.imageCtx=o.imageCanvas.getContext("2d"),o.bufferPaintList=[],o.bufferTool="none",o.bufferRenderMode="none",o.readyToFlood=!1,o.hasFlood=!1,o}return Object(u.a)(t,e),Object(h.a)(t,[{key:"drawTint",value:function(e,t,o,s){e.globalCompositeOperation="source-over",e.fillStyle=t,e.beginPath(),e.rect(0,0,o,s),e.fill()}},{key:"changeBrushSource",value:function(e){this.shadowShape.src=e}},{key:"drawPolygons",value:function(e,t,o,s,i,a,n,r){var h=this;e.clearRect(0,0,s,i),e.fillStyle=o,e.strokeStyle=o,a&&(this.drawTint(e,o,s,i),e.fillStyle=o,e.globalCompositeOperation="destination-out",e.beginPath(),e.moveTo(t[0].x,t[0].y),t.forEach(function(o,s){s+1!==t.length&&e.lineTo(t[s+1].x,t[s+1].y)}),e.lineTo(t[0].x,t[0].y),e.fill(),e.closePath(),e.globalCompositeOperation="source-over"),r&&(e.fillStyle=a?"#FFFFFF":o,e.strokeStyle=a?"#FFFFFF00":o,t.forEach(function(o,s){e.restore(),e.beginPath(),e.arc(o.x,o.y,h.props.radius,0,2*Math.PI),e.globalAlpha=1,e.fill(),s+1!==t.length&&(e.lineWidth=2,e.moveTo(t[s].x,t[s].y),e.lineTo(t[s+1].x,t[s+1].y),e.stroke())}))}},{key:"drawCanvas",value:function(e,t,o,s,i,a,n,r,h,l,c){var u,d,m=this.props,f=m.poly,b=m.color,v=this.refs.canvas;this.refs.flood;if(v){this.ctx||(this.ctx=v.getContext("2d"));var y=this.ctx,w=this.imageCtx,x=this.imageCanvas;if("camera"===e&&!s||!this._drawnImage){var C=this.background;C.onload=function(){var e=t.width/o.width,s=t.width*e,i=t.height*e;w.drawImage(C,0,0,s,i),y.drawImage(x,0,0,s,i),console.log("draw image")},C.src=g.a}if("polygon"===e){this.readyToFlood||(this.background.onload=function(){},this.background.src=g.a,this.readyToFlood=!0);var k=!1;if(f!=this.poly||this.bufferTool!=r){this.poly=f;var S="polygon"==r;this.drawPolygons(this.polyCtx,this.poly,b,v.width,v.height,i,n,S),console.log("drawPolygons"),!this._closedShape&&i&&(this._closedShape=!0),this.bufferTool=r,k=!0}if(a&&a.length!=this.bufferPaintList.length&&(this.drawPaint(this.paintCtx,this.shadowCtx,a,t),this.bufferPaintList=Object(p.a)(a),k=!0),h){this.floodCtx.clearRect(0,0,v.width,v.height),this.tempCtx.clearRect(0,0,v.width,v.height),this.drawTint(this.floodCtx,b,v.width,v.height),this.imageCtx.drawImage(this.background,0,0,v.width,v.height);var O=(u=c,d=l,Math.sqrt(Math.pow(u.x-d.x,2)+Math.pow(u.y-d.y,2))/4);!function(e,t,o,s,i,a,n,r){function h(e,t,o,s,i,a,n){return!(e<0||e>=a)&&(0===i[e+3]||(t[3]!==s.a||t[0]!==s.r||t[1]!==s.g||t[2]!==s.b)&&(t[3]===i[e+3]&&t[0]===i[e]&&t[1]===i[e+1]&&t[2]===i[e+2]||Math.abs(t[3]-i[e+3])<=255-n&&Math.abs(t[0]-i[e])<=n&&Math.abs(t[1]-i[e+1])<=n&&Math.abs(t[2]-i[e+2])<=n))}function l(e,t,o,s,i,a,n){return!!h(e,t,0,s,i,a,n)&&(i[e]=s.r,i[e+1]=s.g,i[e+2]=s.b,i[e+3]=s.a,!0)}!function(e,t,o,s,a,n,r){var c,u,d=s.getImageData(0,0,a,n),m=d.data,p=m.length,f=[],b=4*(e+t*a),g=b,v=b,y=4*a,w=[m[b],m[b+1],m[b+2],m[b+3]];if(m[b],m[b+1],m[b+2],m[b+3],!h(b,w,0,o,m,p,r))return!1;for(f.push(b);f.length;)if(l(b=f.pop(),w,0,o,m,p,r)){for(g=b,v=b,c=(u=parseInt(b/y)*y)+y;u<(v-=4)&&l(v,w,0,o,m,p,r););for(;c>(g+=4)&&l(g,w,0,o,m,p,r););for(var x=v;x<g;x+=4)x-y>=0&&h(x-y,w,0,o,m,p,r)&&f.push(x-y),x+y<p&&h(x+y,w,0,o,m,p,r)&&f.push(x+y)}i.clearRect(0,0,a,n),i.putImageData(d,0,0)}(e,t,o,s,a,n,r)}(c.x,c.y,{r:4,g:4,b:4,a:1},this.imageCtx,this.tempCtx,v.width,v.height,O),this.hasFlood=!0,this.floodCtx.globalCompositeOperation="destination-out",this.floodCtx.drawImage(this.tempCanvas,0,0,v.width,v.height),this.floodCtx.globalCompositeOperation="source-over",k=!0}this.bufferRenderMode!=n&&(k=!0),k&&(console.log("letBeDrawn"),y.clearRect(0,0,v.width,v.height),(i||"polygon"===r)&&y.drawImage(this.polyCanvas,0,0,v.width,v.height),"bucket"!==r&&"brush"!==r||!this.hasFlood||y.drawImage(this.floodCanvas,0,0,v.width,v.height),"brush"!==r&&"raw"!==n||(y.drawImage(this.paintCanvas,0,0,v.width,v.height),"raw"!==n&&this.drawStroke(v,y,"#FF0000",.4,n)),"outline"===n&&(y.clearRect(0,0,v.width,v.height),y.drawImage(this.polyCanvas,0,0,v.width,v.height),y.drawImage(this.floodCanvas,0,0,v.width,v.height),y.drawImage(this.paintCanvas,0,0,v.width,v.height),this.drawStroke(v,y,"#FF0000",.4,n))),this.bufferRenderMode=n}this._drawnImage=!0}}},{key:"render",value:function(){var e=this.props,t=e.role,o=e.profile,s=e.feed,a=e.frozen,n=e.closedShape,r=e.paintList,h=e.renderMode,l=e.tool,c=e.flooding,u=e.floodData,d=e.floodOrig;return this.drawCanvas(t,o,s,a,n,r,h,l,c,u,d),this.bufferTool=l,i.a.createElement("canvas",{style:{background:"raw"===h?"#FFFFFF":"transparent",width:o.width,height:o.height,position:"absolute",opacity:"polygon"===t&&"raw"!==h&&"outline"!==h?.8:1,mixBlendMode:"inverse"===h?"exclusion":"normal"},width:o.width,height:o.height,ref:"canvas"})}}]),t}(i.a.Component),y=Object(f.withStyles)(Object(m.a)({},{}))(v),w=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(l.a)(this,Object(c.a)(t).call(this))).componentDidMount=function(){e._isMounted=!0},e.componentWillUnmount=function(){e._isMounted=!1},e.state={MouseBrush:0},e._isMounted=!1,e}return Object(u.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,o=e.hidden;return i.a.createElement("img",{className:t.brushImage,style:{visibility:o?"hidden":"visible"},src:this.props.src,id:this.props.id})}}]),t}(i.a.Component),x=Object(f.withStyles)(Object(m.a)({},{brushImage:{position:"absolute",pointerEvents:"none"}}))(w),C={version:"1.2",creator:{name:"WebInspector",version:"537.36"},pages:[],entries:[{startedDateTime:"2018-12-08T13:33:38.425Z",time:6.225352996337577,request:{method:"GET",url:"http://127.0.0.1:5000/socket.io/?camera=TIS-41810580&EIO=3&transport=polling&t=MUE1WJw&sid=ac4cd61fa0304be8ac061ce8650ae0f1",httpVersion:"http/1.0",headers:[{name:"Accept",value:"*/*"},{name:"Referer",value:"http://localhost:3000/"},{name:"Origin",value:"http://localhost:3000"},{name:"User-Agent",value:"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36"}],queryString:[{name:"camera",value:"TIS-41810580"},{name:"EIO",value:"3"},{name:"transport",value:"polling"},{name:"t",value:"MUE1WJw"},{name:"sid",value:"ac4cd61fa0304be8ac061ce8650ae0f1"}],cookies:[],headersSize:-1,bodySize:0},response:{status:200,statusText:"OK",httpVersion:"http/1.0",headers:[{name:"Access-Control-Allow-Origin",value:"http://localhost:3000"},{name:"Date",value:"Sat, 08 Dec 2018 13:33:38 GMT"},{name:"Content-Encoding",value:"gzip"},{name:"Access-Control-Allow-Credentials",value:"true"},{name:"Server",value:"Werkzeug/0.14.1 Python/3.6.3"},{name:"Connection",value:"close"},{name:"Content-Type",value:"application/octet-stream"}],cookies:[],content:{size:56597,width:960,height:820,mimeType:"application/octet-stream",text:"",encoding:"base64"},redirectURL:"",headersSize:-1,bodySize:-1,_transferSize:54418},cache:{},timings:{blocked:.9733529999958118,dns:.0030000000000000027,ssl:-1,connect:.1110000000000001,send:.09999999999999987,wait:3.126000003897585,receive:1.91199999244418,_blocked_queueing:.3529999958118424},serverIPAddress:"127.0.0.1",connection:"357549"}]},k=270,S={width:100,height:100},O=function(e,t,o,s){var i=o/s;return"matrix(".concat(i,", 0, 0, ").concat(i,", ").concat(e,", ").concat(t,")")},z=function(e){function t(e){var o;return Object(r.a)(this,t),(o=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={isConnected:!1,frame:null,poly:[],mouseDrag:-1,radius:6,uniqueKey:Math.round(1e5*Math.random()),zoomCenter:{x:0,y:0},zoomDistance:0,zooming:!1,moving:!1,painting:!1,moveShift:{x:0,y:0},closedShape:!1,showMask:!1,mouseBrush:null,paintList:[],erase:!1,floodData:{},floodOrig:{},flooding:!1},o.blockContextMenu=function(e){o.disabledEvent(e)},o.disabledEvent=function(e){return e.stopPropagation?e.stopPropagation():window.event&&(window.event.cancelBubble=!0),e.preventDefault(),!1},o.mouseWheel=function(e){o.zoomCenter={x:o.mousePos.x,y:o.mousePos.y},o.zoomOffset={x:o.zoomCenter.x-o.zoomCenter.x*o.zoom-o.actPos.x+o.shift.x,y:o.zoomCenter.y-o.zoomCenter.y*o.zoom-o.actPos.y+o.shift.y};var t=o.state.zoomDistance+e.deltaY/10;t=t>k?k:t<0?0:t,o.tempZoom=!0,o.setState({zoomDistance:t,zoomCenter:o.zoomCenter})},o.handleOnNewAnnotatedframe=function(e){o.state.isConnected||(console.log("new frame"),console.log(e)),o.setState({isConnected:!0,frame:e})},o.registerMouseBrush=function(e){},o.mouseTarget=null,o.listenersAreReady=!1,o.mousePos={x:0,y:0},o.mouseCenter={x:0,y:0},o.mouseGlobalPos={x:0,y:0},o.zoomShift={x:0,y:0},o.zoom=1,o.baseZoom=1,o.tempZoom=!1,o.zoomOffset={x:0,y:0},o.shift={x:0,y:0},o.actPos={x:0,y:0},o.prevPos={x:0,y:0},o.prevShift={x:0,y:0},o.mouseGlobalPrev={x:0,y:0},o.zoomCenter={x:0,y:0},o.isMouseOver=!1,o.mouseBrush=null,o.brushSize={width:S.width,height:S.height},o._isBrushVisible=!1,o.brushBuffer={x:0,y:0},o.brushScaleBuffer=0,o}return Object(u.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this._mounted=!0,this.tick()}},{key:"componentWillUnmount",value:function(){this._mounted=!1}},{key:"addMouseListeners",value:function(){var e=this;console.log(this.mouseTarget),this.mouseTarget.addEventListener("mousedown",function(t){return e.mouseAction("mousedown",t)}),document.addEventListener("mouseup",function(t){return e.mouseAction("mouseup",t)}),this.mouseTarget.addEventListener("mousemove",function(t){return e.mouseAction("mousemove",t)}),this.mouseTarget.addEventListener("click",function(t){return e.mouseAction("click",t)}),this.mouseTarget.addEventListener("dblclick",function(t){return e.mouseAction("dblclick",t)}),this.mouseTarget.addEventListener("mouseover",function(t){return e.mouseAction("mouseover",t)}),this.mouseTarget.addEventListener("mouseout",function(t){return e.mouseAction("mouseout",t)}),this.mouseTarget.addEventListener("contextmenu",this.blockContextMenu),this.mouseTarget.addEventListener("mousewheel",function(t){return e.mouseWheel(t)}),this.listenersAreReady=!0}},{key:"mouseAction",value:function(e,t){var o;if(this.disabledEvent(t),"splitted"==this.props.view)switch(e){case"click":this.props.boxClicked(this.props.count)}else switch(this.mousePos={x:t.offsetX,y:t.offsetY},e){case"mousedown":if(this.mouseCenter={x:t.offsetX,y:t.offsetY},this.mouseGlobalCenter={x:t.pageX,y:t.pageY},this.mouseGlobalPos={x:t.pageX,y:t.pageY},this.mouseGlobalPrev={x:t.pageX,y:t.pageY},this.props.mod.shift){this.baseZoom=this.zoom,this.zoomCenter={x:t.offsetX,y:t.offsetY};this.actPos;this.zoomOffset={x:this.zoomCenter.x-this.zoomCenter.x*this.zoom-this.actPos.x+this.shift.x,y:this.zoomCenter.y-this.zoomCenter.y*this.zoom-this.actPos.y+this.shift.y},console.log(this.zoomCenter.x-this.zoomCenter.x*this.zoom+" "+this.actPos.x),this.setState({zooming:!0,zoomCenter:{x:t.offsetX,y:t.offsetY},zoomDistance:0})}else if(this.props.mod.space)this.setState({moving:!0});else if(this.props.mod.ctrl||3===t.which){if("brush"===this.props.tool){var s={src:this.props.brushData.fill,erase:!0,pos:{x:t.offsetX,y:t.offsetY},size:this.brushSize};this.setState({paintList:[].concat(Object(p.a)(this.state.paintList),[s]),painting:!0,erase:!0})}}else switch(this.props.tool){case"brush":var i={src:this.props.brushData.fill,erase:!1,pos:{x:t.offsetX,y:t.offsetY},size:this.brushSize};this.setState({paintList:[].concat(Object(p.a)(this.state.paintList),[i]),painting:!0,erase:!1});break;case"polygon":(o=this.shouldDrag({x:t.offsetX,y:t.offsetY}))<0?this.state.closedShape||(o=this.state.poly.length,this.setState({mouseDrag:o,poly:[].concat(Object(p.a)(this.state.poly),[{x:t.offsetX,y:t.offsetY}])})):this.setState({mouseDrag:o});break;case"bucket":this.setState({flooding:!0,floodData:{x:t.offsetX,y:t.offsetY},floodOrig:{x:t.offsetX,y:t.offsetY}})}break;case"mouseup":this.setState({mouseDrag:-1,zooming:!1,moving:!1,painting:!1,erase:!1,flooding:!1});break;case"mousemove":if(this.isMouseOver=!0,this.mousePos={x:t.offsetX,y:t.offsetY},this.mouseGlobalPos={x:t.pageX,y:t.pageY},"bucket"===this.props.tool&&this.state.flooding&&this.setState({floodData:{x:t.offsetX,y:t.offsetY}}),this.state.zooming){var a=this.mouseGlobalPos.y-this.mouseGlobalCenter.y;this.setState({zoomDistance:a})}if(this.state.moving&&(this.shift={x:this.shift.x+(this.mouseGlobalPos.x-this.mouseGlobalPrev.x),y:this.shift.y+(this.mouseGlobalPos.y-this.mouseGlobalPrev.y)},this.mouseGlobalPrev={x:this.mouseGlobalPos.x,y:this.mouseGlobalPos.y},this.setState({moveShift:this.shift})),"brush"===this.props.tool&&this.state.painting){var n={src:this.props.brushData.fill,erase:this.state.erase,pos:{x:t.offsetX,y:t.offsetY},size:this.brushSize};this.setState({paintList:[].concat(Object(p.a)(this.state.paintList),[n])})}break;case"click":0===(o=this.shouldDrag({x:t.offsetX,y:t.offsetY}))&&this.state.poly.length>2&&t.offsetX===this.mouseCenter.x&&t.offsetY===this.mouseCenter.y&&!this.state.closedShape&&(this.props.closedShapeCallback(this.props.count),this.setState({closedShape:!0}));break;case"dblclick":(o=this.shouldDrag({x:t.offsetX,y:t.offsetY}))>0&&this.setState({mouseDrag:-1,poly:[].concat(Object(p.a)(this.state.poly.slice(0,o)),Object(p.a)(this.state.poly.slice(o+1)))});break;case"keypress":console.log(t.key),t.key;break;case"mouseover":break;case"mouseout":this.isMouseOver=!1,this.setState({mouseDrag:-1,zooming:!1,painting:!1,erase:!1,flooding:!1})}}},{key:"shouldDrag",value:function(e){var t=this,o=-1;return this.state.poly.forEach(function(s,i){var a=t.state.radius;Math.sqrt((e.x-s.x)*(e.x-s.x)+(e.y-s.y)*(e.y-s.y))<a&&(o=i)}),o}},{key:"tick",value:function(){if(this._mounted){var e=!1;if(this.brushScaleBuffer!=this.props.brushScale&&(this.brushSize={width:S.width*this.props.brushScale,height:S.height*this.props.brushScale},this.brushScaleBuffer=this.props.brushScale,e=!0),this.state.mouseDrag>=0){var t=Object(p.a)(this.state.poly);t[this.state.mouseDrag]={x:this.mousePos.x,y:this.mousePos.y},this.setState({poly:t})}this.state.zooming,this.mouseBrush||(this.mouseBrush=document.getElementById("brush"+this.state.uniqueKey)),this.mouseBrush&&(this.brushBuffer.x!==this.mousePos.x||this.brushBuffer.y!==this.mousePos.y||e)&&(this.isMouseOver&&!this.props.hideMouse||e?(this._isBrushVisible=!0,console.log(this._isBrushVisible),this.mouseBrush.style="transform: matrix(1, 0, 0, 1, "+(this.mousePos.x-this.brushSize.width/2)+", "+(this.mousePos.y-this.brushSize.height/2)+"); width:"+this.brushSize.width+"px; height:"+this.brushSize.height+"px;"):this._isBrushVisible&&(this.mouseBrush.style="transform: matrix(1, 0, 0, 1, "+-this.brushSize.width+", "+-this.brushSize.height+");",this._isBrushVisible=!1),this.brushBuffer={x:this.mousePos.x,y:this.mousePos.y}),window.requestAnimationFrame(this.tick.bind(this))}}},{key:"initConnection",value:function(){this.handleOnNewAnnotatedframe(C.entries[0].response.content)}},{key:"render",value:function(){var e=this,t=this.props,o=t.classes,s=(t.count,t.active,t.profile),a=(t.key,t.origin,t.actPos),n=t.zIndex,r=t.animated,h=t.renderMode,l=(t.brushScale,t.brushData),c=t.hideMouse,u=t.tool,d=this.state,m=d.isConnected,p=d.frame,f=d.uniqueKey,b=d.zooming,g=d.zoomDistance,v=(d.zoomCenter,d.moving,d.paintList),w=(d.painting,d.flooding),C=d.floodData,k=d.floodOrig;s&&!this.state.isConnected&&this.initConnection(),m&&this.mouseTarget&&!this.listenersAreReady&&this.addMouseListeners(),(b||this.tempZoom)&&(this.tempZoom=!1,this.zoom=this.baseZoom+g/300,this.zoom=this.zoom<1?1:this.zoom>100?100:this.zoom);return this.actPos=function(e,t,o,s,i){var a=e.x+t.x-t.x*o-s.x,n=e.y+t.y-t.y*o-s.y;return a>0&&(a=0),n>0&&(n=0),a<i.width-i.width*o&&(a=i.width-i.width*o),n<i.height-i.height*o&&(n=i.height-i.height*o),{x:a,y:n}}(this.shift,this.zoomCenter,this.zoom,this.zoomOffset,s),i.a.createElement("div",{className:r?o.animated:o.canvas_container,style:{transform:O(a.x,a.y,a.width,s.width),transformOrigin:"0 0",width:s.width,height:s.height,overflow:"hidden",position:"absolute",zIndex:n}},m?i.a.createElement("div",{className:o.canvas_container,ref:function(t){return e.mouseTarget=t},style:{transform:"matrix("+this.zoom+", 0, 0, "+this.zoom+", "+this.actPos.x+", "+this.actPos.y+")",transformOrigin:"0 0"}},i.a.createElement(y,{role:"camera",profile:s,feed:p,frozen:!0,key:"CameraDrawerCam"+f}),i.a.createElement(y,{role:"polygon",profile:s,feed:p,frozen:!1,poly:this.state.poly,radius:this.state.radius,closedShape:this.state.closedShape,color:"#ffc600",key:"CameraDrawerPoly"+f,paintList:v,shape:l.fill,renderMode:h,tool:u,flooding:w,floodData:C,floodOrig:k}),i.a.createElement(x,{x:this.mousePos.x,y:this.mousePos.y,src:l.mouse,key:"brush-head-"+f,id:"brush"+f,ref:function(t){return e.registerMouseBrush(t)},hidden:c}),"}"):i.a.createElement("div",null))}}]),t}(i.a.Component),E=Object(f.withStyles)(Object(m.a)({},{canvas_container:{transform:"rotateZ(0.0001)",position:"absolute"},animated:{transitionProperty:"transform",transitionDuration:"0.4s",transitionTimingFunction:"ease-in-out"},tempButton:{transform:"matrix(1.5, 0, 0, 1.5, 0, 0)",position:"absolute",transformOrigin:"0 0"}}))(z),j=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(l.a)(this,Object(c.a)(t).call(this))).componentDidMount=function(){e._isMounted=!0},e.componentWillUnmount=function(){e._isMounted=!1},e.state={},e._isMounted=!1,e}return Object(u.a)(t,e),Object(h.a)(t,[{key:"click",value:function(e){this.props.callback(this.props.map.key)}},{key:"render",value:function(){var e=this,t=this.props,o=t.classes,s=t.map,a=t.key,n=t.triggered;return i.a.createElement("div",{className:o.toolboxButton,style:{background:n&&!s.notrigger?"rgba(255,198,0,1)":"transparent"},onClick:function(t){return e.click(t)},key:a},i.a.createElement("img",{className:o.toolboxImage,src:s.src}))}}]),t}(i.a.Component),M=Object(f.withStyles)(Object(m.a)({},{toolboxButton:{width:"6em",height:"6em",cursor:"pointer","&:hover":{background:"rgba(255,198,0,0.3)"}},toolboxImage:{filter:"grayscale(100%) brightness(0.3)",width:"64%",height:"64%",padding:"15% 15% 15% 20%"}}))(j),P=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(l.a)(this,Object(c.a)(t).call(this))).componentDidMount=function(){e._isMounted=!0},e.componentWillUnmount=function(){e._isMounted=!1},e.state={},e._isMounted=!1,e}return Object(u.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.props,o=t.classes,s=t.map,a=t.trigger,n=t.side,r=s.buttons.map(function(t,o){return i.a.createElement(M,{map:t,callback:e.props.callback,key:t.key,triggered:a==o})});return i.a.createElement("div",{className:o.toolboxGroup,style:{transform:"right"===n?"none":"matrix(-1, 0, 0, 1, 0, 0)"}},Object(p.a)(r))}}]),t}(i.a.Component),D=Object(f.withStyles)(Object(m.a)({},{toolboxGroup:{boxSizing:"border-box",borderWidth:"0.1em 0 0.1em 0.1em",borderRadius:"2em 0 0 2em",borderStyle:"solid",borderRight:"none",borderColor:"#3c3c3c",overflow:"hidden",height:"auto",width:"auto",marginBottom:"5.6em"}}))(P),_=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(l.a)(this,Object(c.a)(t).call(this))).componentDidMount=function(){e._isMounted=!0},e.componentWillUnmount=function(){e._isMounted=!1},e.state={},e._isMounted=!1,e}return Object(u.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,o=e.map,s=e.trigger,a=e.hidden,n=e.side;console.log(o.groups);var r=o.groups.map(function(e,t){return i.a.createElement(D,{map:e,callback:o.callback,key:e.key,trigger:s,side:n})}),h="right"===n?"100%":"-100%";return console.log(n),console.log(h),i.a.createElement("div",{className:t.toolbox,style:{transform:a?"translate("+h+", -50%)":"translate(0%, -50%)",right:"right"===n?"0":"auto",left:"left"===n?"0":"auto"}},Object(p.a)(r))}}]),t}(i.a.Component),T=Object(f.withStyles)(Object(m.a)({},{toolbox:{position:"absolute",top:"46%",transitionProperty:"transform",transitionDuration:"0.4s",transitionTimingFunction:"ease-in-out",zIndex:1}}))(_),I=o(62),A=o.n(I),B=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(l.a)(this,Object(c.a)(t).call(this))).componentDidMount=function(){e._isMounted=!0},e.componentWillUnmount=function(){e._isMounted=!1},e.onMouseOver=function(){e.setState({openDialog:!0})},e.onMouseOut=function(){e.setState({openDialog:!1})},e.state={openDialog:!1},e._isMounted=!1,e}return Object(u.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.classes;return i.a.createElement("div",{className:e.tempInfo,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut},i.a.createElement("div",{className:e.tempDetails,style:{display:this.state.openDialog?"block":"none"}},i.a.createElement("p",{className:e.bold},"Modifyers"),i.a.createElement("span",{className:e.bold}," Shift + DragUpDown / Scroll: ")," Zoom",i.a.createElement("br",null),i.a.createElement("span",{className:e.bold}," Space + Drag: ")," Move",i.a.createElement("br",null),i.a.createElement("span",{className:e.bold}," z: ")," Normal view",i.a.createElement("br",null),i.a.createElement("span",{className:e.bold}," x: ")," Inverse (like) view",i.a.createElement("br",null),i.a.createElement("span",{className:e.bold}," c: ")," RAW view",i.a.createElement("br",null),i.a.createElement("span",{className:e.bold}," v: ")," Outline view",i.a.createElement("br",null),i.a.createElement("p",{className:e.bold},"Polygon Tool"),i.a.createElement("span",{className:e.bold}," Click + Drag: "),"Draw and drag polygons until closed shape",i.a.createElement("br",null),i.a.createElement("span",{className:e.bold}," Double Click on Polygon: "),"Remove polygon",i.a.createElement("br",null),i.a.createElement("p",{className:e.bold},"Bucket Tool"),i.a.createElement("span",{className:e.bold}," Click + Drag: "),"Set tolerance for the clicked point",i.a.createElement("br",null),i.a.createElement("p",{className:e.bold},"Brush Tool"),i.a.createElement("span",{className:e.bold}," Click + Drag: "),"Draw with selected shape",i.a.createElement("br",null),i.a.createElement("span",{className:e.bold}," Ctrl + Click / Right Click: "),"Erase brush (doesn't effect flood fill and polygons)",i.a.createElement("br",null),i.a.createElement("span",{className:e.bold}," Up Arrow: "),"Increse brush size",i.a.createElement("br",null),i.a.createElement("span",{className:e.bold}," Down Arrow: "),"Decrese brush size",i.a.createElement("br",null)),i.a.createElement("img",{className:e.tempIcon,src:A.a}))}}]),t}(i.a.Component),F=Object(f.withStyles)(Object(m.a)({},{tempInfo:{position:"absolute",left:0,fontColor:"#CCCCCC",bottom:"1em",width:"auto",height:"auto"},tempDetails:{position:"absolute",bottom:0,left:0,fontColor:"#CCCCCC",padding:"1em",paddingBottom:"5.2em",width:"20em",height:"auto",userSelect:"none",background:"white",zIndex:1},tempIcon:{position:"absolute",width:"2.6em",height:"2.6em",bottom:0,left:"1em"},bold:{paddingTop:"1em",fontWeight:"bold",paddingBottom:"0em",marginBottom:"0.7em"}}))(B),N=o(38),L=o.n(N),R=o(24),W=o.n(R),X=o(63),Y=o.n(X),G=o(39),U=o.n(G),q=o(64),H=o.n(q),Z=o(40),V=o.n(Z),K=o(65),J=o.n(K),$=o(41),Q=o.n($),ee=o(66),te=o.n(ee),oe=o(42),se=o.n(oe),ie=o(67),ae=o.n(ie),ne=o(43),re=o.n(ne),he=o(68),le=o.n(he),ce=o(69),ue=o.n(ce),de=o(70),me=o.n(de),pe=o(71),fe=o.n(pe),be={width:960,height:820},ge=[{callback:null,side:"right",groups:[{key:"bushes",buttons:[{src:W.a,key:"brush_0"},{src:U.a,key:"brush_1"},{src:V.a,key:"brush_2"},{src:Q.a,key:"brush_3"},{src:se.a,key:"brush_4"},{src:re.a,key:"brush_5"}]}]}],ve=[{callback:null,side:"left",groups:[{key:"tools",buttons:[{src:le.a,key:"polygon"},{src:ue.a,key:"bucket"},{src:me.a,key:"brush"}]},{key:"views",buttons:[{notrigger:!0,src:fe.a,key:"split"}]}]}],ye=!1,we={width:2,height:2},xe=.1,Ce=8,ke=[{x:0,y:0},{x:.5,y:0},{x:0,y:.5},{x:.5,y:.5}],Se=[{width:be.width,height:be.height,id:0},{width:be.width,height:be.height,id:0},{width:be.width,height:be.height,id:0},{width:be.width,height:be.height,id:0}],Oe=Se.map(function(){return!1}),ze=function(e){function t(e){var o;return Object(r.a)(this,t),(o=Object(l.a)(this,Object(c.a)(t).call(this,e))).getPositions=function(e,t,s){if(!t)return{x:0,y:0,width:2,height:2};var i=.01*t.height,a=t.width/be.width>t.height/be.height,n=t.height/be.height,r=t.width/be.width,h={x:a?(t.width-be.width*n)/2:0,y:a?0:(t.height-be.height*r)/2,width:a?be.width*n:t.width,height:a?t.height:be.height*r};switch(o.state.view){case"single":if(o.state.active===e)return h;case"splitted":return{x:i+h.x+h.width*s[e].x,y:i+h.y+h.height*s[e].y,width:h.width/2-2*i,height:h.height/2-2*i}}},o.boxClicked=function(e){ye=!0,o.setState({view:"single",active:e,isToolboxHidden:!1})},o.closedShapeCallback=function(e){Oe[e]=!0,o.setState({isToolboxHidden:!1})},o.brushSelect=function(e){var t=null;switch(e){case"brush_0":t={fill:W.a,mouse:L.a,count:0};break;case"brush_1":t={fill:U.a,mouse:Y.a,count:1};break;case"brush_2":t={fill:V.a,mouse:H.a,count:2};break;case"brush_3":t={fill:Q.a,mouse:J.a,count:3};break;case"brush_4":t={fill:se.a,mouse:te.a,count:4};break;case"brush_5":t={fill:re.a,mouse:ae.a,count:5}}t&&o.setState({brushData:t,actBrush:t.count}),console.log("brushSelect "+e)},o.funcSelect=function(e){switch(e){case"polygon":o.setState({tool:e,actToolNum:0});break;case"bucket":o.setState({tool:e,actToolNum:1});break;case"brush":o.setState({tool:e,actToolNum:2});break;case"split":ye=!0,o.setState({view:"splitted",renderMode:"normal",isToolboxHidden:!0})}console.log("funcSelect "+e)},o.state={view:"splitted",active:0,renderMode:"normal",brushScale:1,brushData:{fill:W.a,mouse:L.a},actBrush:0,actToolNum:0,tool:"polygon",isToolboxHidden:!0,mod:{ctrl:!1,shift:!1,alt:!1,space:!1}},o}return Object(u.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",function(t){return e.keyPress(t)}),document.addEventListener("keyup",function(t){return e.keyUp(t)})}},{key:"keyUp",value:function(e){switch(e.preventDefault(),e.key){case"Shift":this.setState({mod:Object.assign(this.state.mod,{shift:!1})});break;case"Control":this.setState({mod:Object.assign(this.state.mod,{ctrl:!1})});break;case"Alt":this.setState({mod:Object.assign(this.state.mod,{alt:!1})});break;case" ":this.state.mod.space&&this.setState({mod:Object.assign(this.state.mod,{space:!1})})}}},{key:"keyPress",value:function(e){switch(e.preventDefault(),e.key){case"Shift":this.setState({mod:Object.assign(this.state.mod,{shift:!0})});break;case"Control":this.setState({mod:Object.assign(this.state.mod,{ctrl:!0})});break;case"Alt":this.setState({mod:Object.assign(this.state.mod,{alt:!0})});break;case" ":this.state.mod.space||this.setState({mod:Object.assign(this.state.mod,{space:!0})})}if("Escape"==e.key&&(ye=!0,this.setState({view:"splitted",renderMode:"normal",isToolboxHidden:!0})),"z"===e.key&&this.setState({renderMode:"normal"}),"x"===e.key&&this.setState({renderMode:"inverse"}),"c"===e.key&&this.setState({renderMode:"raw"}),"v"===e.key&&this.setState({renderMode:"outline"}),"ArrowUp"===e.key){var t=this.state.brushScale+.1;this.setState({brushScale:Ce<t?Ce:t})}if("ArrowDown"===e.key){var o=this.state.brushScale-.1;this.setState({brushScale:xe>o?xe:o})}}},{key:"render",value:function(){var e,t=this,o=this.props,s=o.classes,a=(o.key,o.profilesCombinationId,o.screenSize),n=this.state,r=n.view,h=n.active,l=n.renderMode,c=n.brushScale,u=n.brushData,d=n.actBrush,m=n.isToolboxHidden,f=n.tool,b=n.actToolNum,g=n.mod;we!=(e=a)&&(ye=!1),we=e;var v=[].concat(ge);v[0].callback=this.brushSelect.bind(this);var y=v.map(function(e){return i.a.createElement(T,{map:e,trigger:d,hidden:m||"brush"!==f,side:e.side})}),w=[].concat(ve);w[0].callback=this.funcSelect.bind(this),console.log("mouse hidden"+("splitted"==r||"brush"!==f));var x=w.map(function(e){return i.a.createElement(T,{map:e,trigger:b,hidden:m,side:e.side})});return i.a.createElement("div",{className:s.cameraContainer},this.props.profilesCombinationId?Se.map(function(e,o){return i.a.createElement(E,{count:o,active:h,profile:e,key:"box_"+o,origin:{width:Se.width,height:Se.height},actPos:t.getPositions(o,a,ke),view:r,boxClicked:t.boxClicked,closedShapeCallback:t.closedShapeCallback,zIndex:h===o?1:0,animated:ye,renderMode:l,brushScale:c,brushData:u,hideMouse:"splitted"==r||"brush"!==f,mod:g,tool:f})}):i.a.createElement("div",null),Object(p.a)(y),Object(p.a)(x),i.a.createElement(F,null))}}]),t}(i.a.Component);ze.defaultProps={};var Ee=Object(f.withStyles)(Object(m.a)({},{cameraContainer:{position:"absolute",width:"100%",height:"100%"}}))(ze),je=function(e){function t(e){var o;return Object(r.a)(this,t),(o=Object(l.a)(this,Object(c.a)(t).call(this,e))).resizer=function(){window.requestAnimationFrame(o.resizeHelper.bind(Object(d.a)(Object(d.a)(o))))},o.state={screenSize:null},o}return Object(u.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resizer.bind(this)),this.resizer()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizer.bind(this))}},{key:"resizeHelper",value:function(){this.setState({screenSize:{width:window.innerWidth,height:window.innerHeight}})}},{key:"render",value:function(){var e=this.state.screenSize;return i.a.createElement("div",{className:"App",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}},i.a.createElement(Ee,{screenSize:e,key:"inspection-manager-screen-0",profilesCombinationId:"profileCombinationIdToLoad"}))}}]),t}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n.a.render(i.a.createElement(je,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},24:function(e,t,o){e.exports=o.p+"static/media/brush_0.50659df5.svg"},37:function(e,t,o){e.exports=o.p+"static/media/test_left.404d5289.png"},38:function(e,t,o){e.exports=o.p+"static/media/mouse_0.565288ed.svg"},39:function(e,t,o){e.exports=o.p+"static/media/brush_1.f6d9273b.svg"},40:function(e,t,o){e.exports=o.p+"static/media/brush_2.9829f4a6.svg"},41:function(e,t,o){e.exports=o.p+"static/media/brush_3.5e6e9e51.svg"},42:function(e,t,o){e.exports=o.p+"static/media/brush_4.5fd43708.svg"},43:function(e,t,o){e.exports=o.p+"static/media/brush_5.30137959.svg"},62:function(e,t,o){e.exports=o.p+"static/media/info_icon.61c5806a.svg"},63:function(e,t,o){e.exports=o.p+"static/media/mouse_1.31fca215.svg"},64:function(e,t,o){e.exports=o.p+"static/media/mouse_2.5320bb3f.svg"},65:function(e,t,o){e.exports=o.p+"static/media/mouse_3.4f56423b.svg"},66:function(e,t,o){e.exports=o.p+"static/media/mouse_4.54a093f4.svg"},67:function(e,t,o){e.exports=o.p+"static/media/mouse_5.adf699a0.svg"},68:function(e,t,o){e.exports=o.p+"static/media/tool_polygon.cc56ea72.svg"},69:function(e,t,o){e.exports=o.p+"static/media/tool_bucket.50fc8080.svg"},70:function(e,t,o){e.exports=o.p+"static/media/tool_brush.c95a3835.svg"},71:function(e,t,o){e.exports=o.p+"static/media/view_split.1f356a75.svg"},72:function(e,t,o){e.exports=o(146)},77:function(e,t,o){},78:function(e,t,o){e.exports=o.p+"static/media/logo.5d5d9eef.svg"},79:function(e,t,o){}},[[72,1,2]]]);
//# sourceMappingURL=main.01aca006.chunk.js.map